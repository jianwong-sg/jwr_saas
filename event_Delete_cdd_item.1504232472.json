{
	"type": "EVENT_BUTTON",
	"name": "Delete_cdd_item",
	"serverCode": "global $dal;\n \nwhile ( $data = $button->getNextSelectedRecord() ) {\n\n// Update and clear fields in the master `transactions` table\n$sql = \"UPDATE transactions SET client='',client_id='',client_type='',cdd_result='',sls_cust='',sls_result='',pps_cust='', \npps_result='',cdd_check_result='',namelist_cust='',namelist_result='',alertlist_cust='',alertlist_result='' WHERE id = \".$data[\"id_cddlist\"];\nCustomQuery($sql);\n\n// Delete related records in `cdd_measures` and `str` tables using `id_cddlist`\n$sql = \"DELETE FROM cdd_checklist WHERE id = \".$data[\"id\"];\nCustomQuery($sql);  \n\n$sql = \"DELETE FROM cdd_measures WHERE id_cddmeasures = \".$data[\"id_cddlist\"];\nCustomQuery($sql);    \n\n$sql = \"DELETE FROM str WHERE id_tx = \".$data[\"id_cddlist\"];\nCustomQuery($sql);\n}\n\n// Optionally, return a success message or perform additional actions if needed",
	"beforeJsCode": "// Get all selected checkboxes\nvar selectedRecords = $('input[type=\"checkbox\"][name=\"selection[]\"]:checked');\n\n// Check if any records are selected\nif (selectedRecords.length === 0) {\n    swal(\"Please check the box to delete record.\");\n    return false; // Prevent further action if no record is selected\n}\n\nswal({\n    title: \"Do you really want to delete this record?\",\n    text: \"It will also delete any previously lodged CDD Measures and STR files for this transaction. Once deleted, you will not be able to recover this record!\",\n    icon: \"warning\",\n    buttons: {\n        cancel: \"Cancel\",\n        proceed: {\n            text: \"Yes. Proceed to Delete\",\n            value: \"proceed\",\n        }\n\t\t}\n    })\n.then((value) => {\n    if (value === \"proceed\") {\n        submit();\n    }\n});\n\nreturn false;",
	"afterJsCode": "parent.location.reload();"
}